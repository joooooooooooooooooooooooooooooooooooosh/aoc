#!/bin/sh

_() {
    sed -E 's/(.)/\1 /g' | rs -c' ' -C' ' -T | tr -d ' ' | sed -E '
:a
s/(S\|*)\.(\.*\^)/\1|\2/
ta
' | sed 's/S/A/; s/\|\^/|B/' |
        sed -E 's/(.)/\1 /g' | rs -c' ' -C' ' -T | tr -d ' ' | sed 's/\.B/SB/g; s/B\./BS/g'
}

<input _ | _ | _ | _ | _ | _ | _ | _ | _ | _ | _ | _ | _ | _ | _ | _ | _ | _ | _ | _ | _ | _ | _ | _ | _ | _ | _ | _ | _ | _ | _ | _ | _ | _ | _ | _ | _ | _ | _ | _ | _ | _ | _ | _ | _ | _ | _ | _ | _ | _ | _ | _ | _ | _ | _ | _ | _ | _ | _ | _ | _ | _ | _ | _ | _ | _ | _ | _ | _ | _ | _ | _ | _ | _ | grep -o B | wc -l
